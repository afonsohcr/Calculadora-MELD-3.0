<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora MELD 3.0</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Preston:wght@400;700&display=swap">
    <style>
        body {
            font-family: 'Preston', sans-serif;
            background: linear-gradient(135deg, #dfcae1, #d9e2ec);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }
        .calculator {
            background: #ffffff;
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            padding: 20px;
            width: 320px;
            max-width: 95%;
            display: flex;
            flex-direction: column;
        }
        h1 {
            font-size: 1.5em;
            color: #a788ab;
            text-align: center;
            margin-bottom: 15px;
        }
        .form-group {
            margin-bottom: 12px;
        }
        label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: #2c3e50;
            font-size: 0.9em;
        }
        input[type="number"] {
            width: 100%;
            padding: 8px;
            border: 1px solid #bdc3c7;
            border-radius: 8px;
            font-size: 0.9em;
        }
        .radio-group {
            display: flex;
            margin-bottom: 12px;
        }
        .radio-option {
            flex: 1;
            height: 35px;
            line-height: 35px;
            text-align: center;
            border: 2px solid #bdc3c7;
            cursor: pointer;
            font-size: 0.9em;
        }
        .radio-option:first-child {
            border-radius: 8px 0 0 8px;
        }
        .radio-option:last-child {
            border-radius: 0 8px 8px 0;
        }
        .radio-option.selected {
            background-color: #a788ab;
            color: white;
            border-color: #a788ab;
        }
        .button-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 10px;
        }
        button {
            background-color: #a788ab;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
        }
        button:hover {
            background-color: #8d6e78;
        }
        .button-limpar {
            background-color: #FF6347;
        }
        .button-limpar:hover {
            background-color: #e55347;
        }
        .result {
            margin-top: 15px;
            font-size: 1.2em;
            font-weight: bold;
            text-align: center;
            color: #2c3e50;
        }
        .result span {
            color: #e74c3c;
        }
        .credits {
            margin-top: 15px;
            font-size: 0.75em;
            color: #7f8c8d;
            text-align: center;
        }
    </style>
</head>
<body>

<div class="calculator">
    <h1>Calculadora MELD 3.0</h1>

    <div class="form-group">
        <label>Sexo:</label>
        <div class="radio-group">
            <div class="radio-option selected" id="sexo-masculino" onclick="selectSexo('masculino')">Masculino</div>
            <div class="radio-option" id="sexo-feminino" onclick="selectSexo('feminino')">Feminino</div>
        </div>
    </div>

    <div class="form-group">
        <label for="albumina">Albumina (g/dL):</label>
        <input type="number" id="albumina" step="any" min="0">
    </div>

    <div class="form-group">
        <label for="bilirubina">Bilirrubina (mg/dL):</label>
        <input type="number" id="bilirubina" step="any" min="0">
    </div>

    <div class="form-group">
        <label for="rni">INR:</label>
        <input type="number" id="rni" step="any" min="0">
    </div>

    <div class="form-group">
        <label for="creatinina">Creatinina (mg/dL):</label>
        <input type="number" id="creatinina" step="any" min="0">
    </div>

    <div class="form-group">
        <label for="sodio">Sódio (mEq/L):</label>
        <input type="number" id="sodio" step="any" min="0">
    </div>

    <label>Hemodiálise ≥ 2 sessões na última semana?</label>
    <div class="radio-group">
        <div class="radio-option" id="hemodialise-sim" onclick="selectHemodialise('sim')">Sim</div>
        <div class="radio-option selected" id="hemodialise-nao" onclick="selectHemodialise('nao')">Não</div>
    </div>

    <div class="button-group">
        <button onclick="calcularMeld3()">Calcular MELD 3.0</button>
        <button class="button-limpar" onclick="limparCampos()">Limpar</button>
    </div>

    <div id="resultado" class="result"></div>

    <div class="credits">
        Desenvolvido por Franklin R. e Patrick R.
    </div>
</div>

<script>
    let sexo = 'masculino';
    let hemodialise = 'nao';

    function selectSexo(valor) {
        sexo = valor;
        document.querySelectorAll('#sexo-masculino, #sexo-feminino')
            .forEach(el => el.classList.remove('selected'));
        document.getElementById(`sexo-${valor}`).classList.add('selected');
    }

    function selectHemodialise(valor) {
        hemodialise = valor;
        document.querySelectorAll('#hemodialise-sim, #hemodialise-nao')
            .forEach(el => el.classList.remove('selected'));
        document.getElementById(`hemodialise-${valor}`).classList.add('selected');
    }

    function calcularMeld3() {
        const ln = Math.log;

        let bilirrubina = Math.max(1, parseFloat(document.getElementById('bilirubina').value) || 1);
        let inr = Math.max(1, parseFloat(document.getElementById('rni').value) || 1);
        let creatinina = Math.max(1, parseFloat(document.getElementById('creatinina').value) || 1);
        let sodio = parseFloat(document.getElementById('sodio').value) || 137;
        let albumina = parseFloat(document.getElementById('albumina').value) || 3.5;

        sodio = Math.max(125, Math.min(137, sodio));
        albumina = Math.max(1.5, Math.min(3.5, albumina));

        if (creatinina > 3 || hemodialise === 'sim') {
            creatinina = 3;
        }

        const feminino = sexo === 'feminino' ? 1 : 0;

        const meld3 =
            1.33 * feminino +
            4.56 * ln(bilirrubina) +
            0.82 * (137 - sodio) -
            0.24 * (137 - sodio) * ln(bilirrubina) +
            9.09 * ln(inr) +
            11.14 * ln(creatinina) +
            1.85 * (3.5 - albumina) -
            1.83 * (3.5 - albumina) * ln(creatinina) +
            6;

        document.getElementById('resultado').innerHTML =
            `MELD 3.0: <span>${Math.round(meld3)}</span>`;
    }

    function limparCampos() {
        document.querySelectorAll('input').forEach(i => i.value = '');
        selectSexo('masculino');
        selectHemodialise('nao');
        document.getElementById('resultado').innerHTML = '';
    }
</script>

</body>
</html>
